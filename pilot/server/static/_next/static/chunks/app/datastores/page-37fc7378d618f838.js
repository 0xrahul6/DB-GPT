(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{31982:function(e,t,n){Promise.resolve().then(n.bind(n,44323))},44323:function(e,t,n){"use strict";n.r(t);var a=n(9268),o=n(56008),s=n(86006),r=n(72474),i=n(59534),c=n(50157),l=n(23910),d=n(21628),h=n(50645),p=n(5737),x=n(78635),u=n(53113),g=n(83192),m=n(58927),j=n(11437),f=n(90545),y=n(70900),b=n(35086),w=n(866),P=n(22046),Z=n(28086);let{Dragger:S}=c.default,C=(0,h.Z)(p.Z)(e=>{let{theme:t}=e;return{width:"33%",backgroundColor:"dark"===t.palette.mode?t.palette.background.level1:"#fff",...t.typography.body2,padding:t.spacing(1),textAlign:"center",borderRadius:4,color:t.vars.palette.text.secondary}}),T=["Knowledge Space Config","Choose a Datasource type","Setup the Datasource"],k=[{type:"text",title:"Text",subTitle:"Fill your raw text"},{type:"webPage",title:"URL",subTitle:"Fetch the content of a URL"},{type:"file",title:"Document",subTitle:"Upload a document, document type can be PDF, CSV, Text, PowerPoint, Word, Markdown"}];t.default=()=>{let e=(0,o.useRouter)(),{mode:t}=(0,x.tv)(),[n,c]=(0,s.useState)(0),[h,v]=(0,s.useState)(""),[O,_]=(0,s.useState)([]),[N,F]=(0,s.useState)(!1),[D,R]=(0,s.useState)(""),[W,E]=(0,s.useState)(""),[J,U]=(0,s.useState)(""),[L,z]=(0,s.useState)(""),[B,K]=(0,s.useState)(""),[M,I]=(0,s.useState)(null),[V,A]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async function(){let e=await fetch("".concat("http://127.0.0.1:5000","/knowledge/space/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),t=await e.json();t.success&&_(t.data)})()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p.Z,{sx:{display:"flex",justifyContent:"space-between"},className:"p-4",children:[(0,a.jsx)(p.Z,{sx:{fontSize:"30px",fontWeight:"bold"},children:"Knowledge Spaces"}),(0,a.jsx)(u.Z,{onClick:()=>F(!0),variant:"outlined",children:"+ New Knowledge Space"})]}),(0,a.jsx)("div",{className:"page-body p-4",children:O.length?(0,a.jsxs)(g.Z,{color:"primary",variant:"plain",size:"lg",sx:{"& tbody tr: hover":{backgroundColor:"light"===t?"rgb(246, 246, 246)":"rgb(33, 33, 40)"},"& tbody tr: hover a":{textDecoration:"underline"},"& tbody tr a":{color:"rgb(13, 96, 217)"}},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Name"}),(0,a.jsx)("th",{children:"Vector"}),(0,a.jsx)("th",{children:"Owner"}),(0,a.jsx)("th",{children:"Description"})]})}),(0,a.jsx)("tbody",{children:O.map(t=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("a",{style:{fontWeight:"bold"},href:"javascript:;",onClick:()=>e.push("/datastores/documents?name=".concat(t.name)),children:t.name})}),(0,a.jsx)("td",{children:(0,a.jsx)(m.Z,{variant:"solid",color:"neutral",sx:{opacity:.5},children:t.vector_type})}),(0,a.jsx)("td",{children:(0,a.jsx)(m.Z,{variant:"solid",color:"neutral",sx:{opacity:.5},children:t.owner})}),(0,a.jsx)("td",{children:(0,a.jsx)(l.Z,{content:t.desc,trigger:"hover",children:t.desc.length>10?"".concat(t.desc.slice(0,10),"..."):t.desc})})]},t.id))})]}):(0,a.jsx)(a.Fragment,{})}),(0,a.jsx)(j.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center","z-index":1e3},open:N,onClose:()=>F(!1),children:(0,a.jsxs)(p.Z,{variant:"outlined",sx:{width:800,borderRadius:"md",p:3,boxShadow:"lg"},children:[(0,a.jsx)(f.Z,{sx:{width:"100%"},children:(0,a.jsx)(y.Z,{spacing:2,direction:"row",children:T.map((e,t)=>(0,a.jsxs)(C,{sx:{fontWeight:n===t?"bold":"",color:n===t?"#814DDE":""},children:[t<n?(0,a.jsx)(i.Z,{}):"".concat(t+1,"."),"".concat(e)]},e))})}),0===n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f.Z,{sx:{margin:"30px auto"},children:["Knowledge Space Name:",(0,a.jsx)(b.ZP,{placeholder:"Please input the name",onChange:e=>R(e.target.value)})]}),(0,a.jsx)(u.Z,{variant:"outlined",onClick:async()=>{if(""===D){d.ZP.error("please input the name");return}let e=await fetch("".concat("http://127.0.0.1:5000","/knowledge/space/add"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:D,vector_type:"Chroma",owner:"keting",desc:"test1"})}),t=await e.json();if(t.success){d.ZP.success("success"),c(1);let e=await fetch("".concat("http://127.0.0.1:5000","/knowledge/space/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),t=await e.json();t.success&&_(t.data)}else d.ZP.error(t.err_msg||"failed")},children:"Next"})]}):1===n?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.Z,{sx:{margin:"30px auto"},children:k.map(e=>(0,a.jsxs)(p.Z,{sx:{boxSizing:"border-box",height:"80px",padding:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between",border:"1px solid gray",borderRadius:"6px",marginBottom:"20px",cursor:"pointer"},onClick:()=>{v(e.type),c(2)},children:[(0,a.jsx)(p.Z,{sx:{fontSize:"20px",fontWeight:"bold"},children:e.title}),(0,a.jsx)(p.Z,{children:e.subTitle})]},e.type))})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f.Z,{sx:{margin:"30px auto"},children:["Name:",(0,a.jsx)(b.ZP,{placeholder:"Please input the name",onChange:e=>U(e.target.value),sx:{marginBottom:"20px"}}),"webPage"===h?(0,a.jsxs)(a.Fragment,{children:["Web Page URL:",(0,a.jsx)(b.ZP,{placeholder:"Please input the Web Page URL",onChange:e=>E(e.target.value)})]}):"file"===h?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(S,{name:"file",multiple:!1,onChange(e){var t;if(console.log(e),0===e.fileList.length){I(null),U("");return}I(e.file.originFileObj),U(null===(t=e.file.originFileObj)||void 0===t?void 0:t.name)},children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(r.Z,{})}),(0,a.jsx)("p",{style:{color:"rgb(22, 108, 255)",fontSize:"20px"},children:"Select or Drop file"}),(0,a.jsx)("p",{className:"ant-upload-hint",style:{color:"rgb(22, 108, 255)"},children:"PDF, PowerPoint, Excel, Word, Text, Markdown,"})]})}):(0,a.jsxs)(a.Fragment,{children:["Text Source(Optional):",(0,a.jsx)(b.ZP,{placeholder:"Please input the text source",onChange:e=>z(e.target.value),sx:{marginBottom:"20px"}}),"Text:",(0,a.jsx)(w.Z,{onChange:e=>K(e.target.value),minRows:4,sx:{marginBottom:"20px"}})]}),(0,a.jsx)(P.ZP,{component:"label",sx:{marginTop:"20px"},endDecorator:(0,a.jsx)(Z.Z,{checked:V,onChange:e=>A(e.target.checked)}),children:"Synch:"})]}),(0,a.jsxs)(y.Z,{direction:"row",justifyContent:"flex-start",alignItems:"center",sx:{marginBottom:"20px"},children:[(0,a.jsx)(u.Z,{variant:"outlined",sx:{marginRight:"20px"},onClick:()=>c(1),children:"< Back"}),(0,a.jsx)(u.Z,{variant:"outlined",onClick:async()=>{if(""===J){d.ZP.error("Please input the name");return}if("webPage"===h){if(""===W){d.ZP.error("Please input the Web Page URL");return}let e=await fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/add"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_name:J,content:W,doc_type:"URL"})}),t=await e.json();t.success?(d.ZP.success("success"),F(!1),V&&fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/sync"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_ids:[t.data]})})):d.ZP.error(t.err_msg||"failed")}else if("file"===h){if(!M){d.ZP.error("Please select a file");return}let e=new FormData;e.append("doc_name",J),e.append("doc_file",M),e.append("doc_type","DOCUMENT");let t=await fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/upload"),{method:"POST",body:e}),n=await t.json();n.success?(d.ZP.success("success"),F(!1),V&&fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/sync"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_ids:[n.data]})})):d.ZP.error(n.err_msg||"failed")}else{if(""===B){d.ZP.error("Please input the text");return}let e=await fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/add"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_name:J,source:L,content:B,doc_type:"TEXT"})}),t=await e.json();t.success?(d.ZP.success("success"),F(!1),V&&fetch("".concat("http://127.0.0.1:5000","/knowledge/").concat(D,"/document/sync"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_ids:[t.data]})})):d.ZP.error(t.err_msg||"failed")}},children:"Finish"})]})]})]})})]})}}},function(e){e.O(0,[430,577,599,86,341,585,672,816,253,769,744],function(){return e(e.s=31982)}),_N_E=e.O()}]);