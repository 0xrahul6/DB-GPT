(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{72431:function(){},91909:function(e,t,i){Promise.resolve().then(i.bind(i,51689))},57931:function(e,t,i){"use strict";i.d(t,{ZP:function(){return c},Cg:function(){return a}});var r=i(9268),n=i(89081),s=i(78915),l=i(86006);let[a,o]=function(){let e=l.createContext(void 0);return[function(){let t=l.useContext(e);if(void 0===t)throw Error("useCtx must be inside a Provider with a value");return t},e.Provider]}();var c=e=>{let{children:t}=e,[i,a]=l.useState(!1),{run:c,data:d,refresh:h}=(0,n.Z)(async()=>await (0,s.Tk)("/v1/chat/dialogue/list"),{manual:!0});return(0,r.jsx)(o,{value:{isContract:i,dialogueList:d,setIsContract:a,queryDialogueList:c,refreshDialogList:h},children:t})}},51689:function(e,t,i){"use strict";let r,n;i.r(t),i.d(t,{default:function(){return et}});var s=i(9268);i(97402),i(23517);var l=i(86006),a=i(56008),o=i(35846),c=i.n(o),d=i(79914),h=i(78635),u=i(18818),x=i(64521),f=i(68113),m=i(70092),p=i(64579),v=i(22046),j=i(53047),g=i(62921),b=i(90545),Z=i(53113),y=i(40020),w=i(11515),k=i(84892),C=i(601),N=i(1301),P=i(98703),_=i(57931),B=i(66664),S=i(78915),z=i(76394),D=i.n(z),E=()=>{var e,t;let i=(0,a.usePathname)(),r=(0,a.useSearchParams)(),n=r.get("id"),o=(0,a.useRouter)(),[z,E]=(0,l.useState)("/LOGO_1.png"),{dialogueList:O,queryDialogueList:I,refreshDialogList:L,isContract:H}=(0,_.Cg)(),{mode:T,setMode:F}=(0,h.tv)(),R=(0,l.useMemo)(()=>[{label:"Knowledge Space",route:"/datastores",icon:(0,s.jsx)(y.Z,{fontSize:"small"}),active:"/datastores"===i}],[i]),A=()=>{"light"===T?F("dark"):F("light")};return(0,l.useEffect)(()=>{"light"===T?E("/LOGO_1.png"):E("/WHITE_LOGO.png")},[T]),(0,l.useEffect)(()=>{(async()=>{await I()})()},[]),H?(0,s.jsxs)(u.Z,{className:"flex flex-col h-full",children:[(0,s.jsxs)(x.Z,{nested:!0,className:"h-full flex-1 overflow-auto",children:[(0,s.jsx)(f.Z,{children:"Dialogue"}),(0,s.jsx)(u.Z,{children:null==O?void 0:null===(e=O.data)||void 0===e?void 0:e.map(e=>{let t=("/chat"===i||"/chat/"===i)&&n===e.conv_uid;return(0,s.jsx)(x.Z,{children:(0,s.jsx)(m.Z,{selected:t,variant:t?"soft":"plain",sx:{"&:hover .del-btn":{visibility:"visible"}},children:(0,s.jsx)(p.Z,{children:(0,s.jsxs)(c(),{href:"/chat?id=".concat(e.conv_uid,"&scene=").concat(null==e?void 0:e.chat_mode),className:"flex items-center justify-between",children:[(0,s.jsxs)(v.ZP,{fontSize:14,noWrap:!0,children:[(0,s.jsx)(P.Z,{style:{marginRight:"0.5rem"}}),(null==e?void 0:e.user_name)||(null==e?void 0:e.user_input)||"undefined"]}),(0,s.jsx)(j.ZP,{color:"neutral",variant:"plain",size:"sm",onClick:t=>{t.preventDefault(),t.stopPropagation(),d.Z.confirm({title:"Delete Chat",content:"Are you sure delete this chat?",width:"276px",zIndex:1002,centered:!0,async onOk(){await (0,S.Kw)("/v1/chat/dialogue/delete?con_uid=".concat(e.conv_uid)),await L(),"/chat"===i&&r.get("id")===e.conv_uid&&o.push("/")}})},className:"del-btn invisible",children:(0,s.jsx)(B.Z,{})})]})})})},e.conv_uid)})})]}),(0,s.jsxs)(x.Z,{nested:!0,className:"h-32",sx:{borderTop:"1px solid",borderColor:"divider"},children:[(0,s.jsx)(f.Z,{children:"Others"}),(0,s.jsxs)(u.Z,{children:[R.map(e=>(0,s.jsx)(c(),{href:e.route,children:(0,s.jsx)(x.Z,{children:(0,s.jsxs)(m.Z,{color:"neutral",sx:{height:"2.5rem",fontSize:"14px"},selected:e.active,variant:e.active?"soft":"plain",children:[(0,s.jsx)(g.Z,{sx:{color:e.active?"inherit":"neutral.500",minInlineSize:"unset",marginRight:"0.5rem"},children:e.icon}),(0,s.jsx)(p.Z,{children:e.label})]})})},e.route)),(0,s.jsx)(x.Z,{children:(0,s.jsxs)(m.Z,{onClick:A,sx:{fontSize:"14px"},children:[(0,s.jsx)(g.Z,{sx:{minInlineSize:"unset",marginRight:"0.5rem"},children:"dark"===T?(0,s.jsx)(w.Z,{fontSize:"small"}):(0,s.jsx)(k.Z,{fontSize:"small"})}),(0,s.jsx)(p.Z,{children:"Theme"})]})})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("nav",{className:"flex h-12 items-center justify-between border-b px-4 dark:border-gray-800 dark:bg-gray-800/70 md:hidden",children:[(0,s.jsx)("div",{children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)("span",{className:"truncate px-4",children:"New Chat"}),(0,s.jsx)("a",{href:"",className:"-mr-3 flex h-9 w-9 shrink-0 items-center justify-center",children:(0,s.jsx)(N.Z,{})})]}),(0,s.jsx)("nav",{className:"grid max-h-screen h-full max-md:hidden",children:(0,s.jsxs)(b.Z,{sx:{display:"flex",flexDirection:"column",borderRight:"1px solid",borderColor:"divider",maxHeight:"100vh",position:"sticky",left:"0px",top:"0px",overflow:"hidden"},children:[(0,s.jsx)(b.Z,{sx:{p:2,gap:2,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)(D(),{src:z,alt:"DB-GPT",width:633,height:157,className:"w-full max-w-full",unoptimized:!0})})}),(0,s.jsx)(b.Z,{sx:{px:2},children:(0,s.jsx)(c(),{href:"/",children:(0,s.jsx)(Z.Z,{color:"primary",className:"w-full bg-gradient-to-r from-[#31afff] to-[#1677ff] dark:bg-gradient-to-r dark:from-[#6a6a6a] dark:to-[#80868f]",style:{color:"#fff"},children:"+ New Chat"})})}),(0,s.jsx)(b.Z,{sx:{p:2,display:{xs:"none",sm:"initial"},maxHeight:"100%",overflow:"auto"},children:(0,s.jsx)(u.Z,{size:"sm",sx:{"--ListItem-radius":"8px"},children:(0,s.jsx)(x.Z,{nested:!0,children:(0,s.jsx)(u.Z,{size:"sm","aria-labelledby":"nav-list-browse",sx:{"& .JoyListItemButton-root":{p:"8px"},gap:"4px"},children:null==O?void 0:null===(t=O.data)||void 0===t?void 0:t.map(e=>{let t=("/chat"===i||"/chat/"===i)&&n===e.conv_uid;return(0,s.jsx)(x.Z,{children:(0,s.jsx)(m.Z,{selected:t,variant:t?"soft":"plain",sx:{"&:hover .del-btn":{visibility:"visible"}},children:(0,s.jsx)(p.Z,{children:(0,s.jsxs)(c(),{href:"/chat?id=".concat(e.conv_uid,"&scene=").concat(null==e?void 0:e.chat_mode),className:"flex items-center justify-between",children:[(0,s.jsxs)(v.ZP,{fontSize:14,noWrap:!0,children:[(0,s.jsx)(P.Z,{style:{marginRight:"0.5rem"}}),(null==e?void 0:e.user_name)||(null==e?void 0:e.user_input)||"undefined"]}),(0,s.jsx)(j.ZP,{color:"neutral",variant:"plain",size:"sm",onClick:t=>{t.preventDefault(),t.stopPropagation(),d.Z.confirm({title:"Delete Chat",content:"Are you sure delete this chat?",width:"276px",centered:!0,async onOk(){await (0,S.Kw)("/v1/chat/dialogue/delete?con_uid=".concat(e.conv_uid)),await L(),"/chat"===i&&r.get("id")===e.conv_uid&&o.push("/")}})},className:"del-btn invisible",children:(0,s.jsx)(B.Z,{})})]})})})},e.conv_uid)})})})})}),(0,s.jsxs)("div",{className:"flex flex-col justify-between flex-1",children:[(0,s.jsx)("div",{}),(0,s.jsx)(b.Z,{sx:{p:2,pt:3,pb:6,borderTop:"1px solid",borderColor:"divider",display:{xs:"none",sm:"initial"},position:"sticky",bottom:0,zIndex:100,background:"var(--joy-palette-background-body)"},children:(0,s.jsxs)(u.Z,{size:"sm",sx:{"--ListItem-radius":"8px"},children:[(0,s.jsx)(x.Z,{nested:!0,children:(0,s.jsx)(u.Z,{size:"sm","aria-labelledby":"nav-list-browse",sx:{"& .JoyListItemButton-root":{p:"8px"}},children:R.map(e=>(0,s.jsx)(c(),{href:e.route,children:(0,s.jsx)(x.Z,{children:(0,s.jsxs)(m.Z,{color:"neutral",sx:{marginBottom:1,height:"2.5rem"},selected:e.active,variant:e.active?"soft":"plain",children:[(0,s.jsx)(g.Z,{sx:{color:e.active?"inherit":"neutral.500"},children:e.icon}),(0,s.jsx)(p.Z,{children:e.label})]})})},e.route))})}),(0,s.jsx)(x.Z,{children:(0,s.jsxs)(m.Z,{sx:{height:"2.5rem"},onClick:A,children:[(0,s.jsx)(g.Z,{children:"dark"===T?(0,s.jsx)(w.Z,{fontSize:"small"}):(0,s.jsx)(k.Z,{fontSize:"small"})}),(0,s.jsx)(p.Z,{children:"Theme"})]})})]})})]})]})})]})},O=i(29720),I=i(41287),L=i(38230);let H=(0,I.Z)({colorSchemes:{light:{palette:{mode:"dark",primary:{...L.Z.grey,solidBg:"#e6f4ff",solidColor:"#1677ff",solidHoverBg:"#e6f4ff"},neutral:{plainColor:"#4d4d4d",plainHoverColor:"#131318",plainHoverBg:"#EBEBEF",plainActiveBg:"#D8D8DF",plainDisabledColor:"#B9B9C6"},background:{body:"#fff",surface:"#fff"},text:{primary:"#505050"}}},dark:{palette:{mode:"light",primary:{...L.Z.grey,softBg:"#353539",softHoverBg:"#35353978",softDisabledBg:"#353539",solidBg:"#51525beb",solidHoverBg:"#51525beb"},neutral:{plainColor:"#D8D8DF",plainHoverColor:"#F7F7F8",plainHoverBg:"#353539",plainActiveBg:"#434356",plainDisabledColor:"#434356",outlinedBorder:"#353539",outlinedHoverBorder:"#454651"},text:{primary:"#EBEBEF"},background:{body:"#212121",surface:"#51525beb"}}}},fontFamily:{body:"Josefin Sans, sans-serif",display:"Josefin Sans, sans-serif"},typography:{display1:{background:"linear-gradient(-30deg, var(--joy-palette-primary-900), var(--joy-palette-primary-400))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}},zIndex:{modal:1001}});var T=i(53794),F=i.n(T),R=i(54486),A=i.n(R);let J=0;function W(){"loading"!==n&&(n="loading",r=setTimeout(function(){A().start()},250))}function G(){J>0||(n="stop",clearTimeout(r),A().done())}if(F().events.on("routeChangeStart",W),F().events.on("routeChangeComplete",G),F().events.on("routeChangeError",G),"function"==typeof(null==window?void 0:window.fetch)){let e=window.fetch;window.fetch=async function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];0===J&&W(),J++;try{let t=await e(...i);return t}catch(e){return Promise.reject(e)}finally{0==(J-=1)&&G()}}}function K(){return null}var M=i(34112),X=i(66694),Y=i(50318),U=i(64747),q=i(5737);function Q(e){let{children:t,title:i,position:r="left",size:n="clamp(256px, 30vw, 378px)",sx:l,...a}=e;return(0,s.jsx)(M.Z,{keepMounted:!0,sx:[{transitionProperty:"visibility",transitionDelay:a.open?"0s":"300ms",["& .".concat(X.Z.backdrop)]:{opacity:a.open?1:0,transition:"opacity 0.3s ease"}},...Array.isArray(l)?l:[l]],...a,children:(0,s.jsxs)(q.Z,{className:"flex flex-col",sx:{px:2,py:1.5,boxSizing:"border-box",position:"fixed",overflow:"auto",outline:"none",maxHeight:"100%",..."left"===r&&{left:0,transform:a.open?"translateX(0)":"translateX(-100%)"},..."right"===r&&{right:0,transform:a.open?"translateX(0)":"translateX(100%)"},..."top"===r&&{top:0,transform:a.open?"translateY(0)":"translateY(-100%)"},..."bottom"===r&&{bottom:0,transform:a.open?"translateY(0)":"translateY(100%)"},height:r.match(/(left|right)/)?"100%":n,width:r.match(/(top|bottom)/)?"100vw":n,boxShadow:"md",transition:"transform 0.3s ease","&:focus-visible":{outline:"none"}},children:[(0,s.jsxs)("div",{className:"h-16",children:[(0,s.jsxs)(b.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(v.ZP,{fontSize:"lg",fontWeight:"lg",sx:{flex:1},children:i}),(0,s.jsx)(U.Z,{sx:{position:"initial"}})]}),(0,s.jsx)(Y.Z,{sx:{mt:1,mb:1.5}})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:t})]})})}var V=i(44972);function $(e){let{children:t}=e,{mode:i}=(0,h.tv)(),r=l.useRef(null);return(0,l.useEffect)(()=>{if((null==r?void 0:r.current)&&i){var e,t,n,s,l,a;null==r||null===(e=r.current)||void 0===e||null===(t=e.classList)||void 0===t||t.add(i),"light"===i?null==r||null===(n=r.current)||void 0===n||null===(s=n.classList)||void 0===s||s.remove("dark"):null==r||null===(l=r.current)||void 0===l||null===(a=l.classList)||void 0===a||a.remove("light")}},[r,i]),(0,s.jsxs)("div",{ref:r,className:"h-full",children:[(0,s.jsx)(K,{}),(0,s.jsx)(_.ZP,{children:t})]})}function ee(e){let{children:t}=e,{isContract:i,setIsContract:r}=(0,_.Cg)(),[n,a]=l.useState(!1);return(0,s.jsxs)(s.Fragment,{children:[i?(0,s.jsxs)("div",{className:"grid h-full w-screen grid-rows-1 grid-cols-[auto,1fr] overflow-hidden text-smd dark:text-gray-300 md:grid-rows-[60px,1fr] md:grid-cols-[1fr]",children:[(0,s.jsxs)("div",{className:"border-[var(--joy-palette-divider)] bg-[#282828] text-[#f4f4f4] border-b border-solid flex items-center px-3 justify-between",children:[(0,s.jsx)(C.Z,{className:"cursor-pointer",onClick:()=>{a(!0)}}),(0,s.jsxs)("div",{className:"flex items-center cursor-pointer",onClick:()=>{r(!i)},children:[(0,s.jsx)(V.Z,{style:{marginRight:"4px"}}),"Change Mode"]})]}),(0,s.jsx)("div",{className:"relative min-h-0 min-w-0",children:t})]}):(0,s.jsxs)("div",{className:"grid h-full w-screen grid-cols-1 grid-rows-[auto,1fr] overflow-hidden text-smd dark:text-gray-300 md:grid-cols-[280px,1fr] md:grid-rows-[1fr]",children:[(0,s.jsx)(E,{}),(0,s.jsx)("div",{className:"relative min-h-0 min-w-0",children:t})]}),(0,s.jsx)(Q,{title:"DB-GPT",position:"left",open:n,onClose:()=>a(!1),children:(0,s.jsx)(E,{})})]})}var et=function(e){let{children:t}=e;return(0,s.jsx)("html",{lang:"en",className:"h-full font-sans",children:(0,s.jsx)("body",{className:"h-full font-sans",children:(0,s.jsx)(O.Z,{theme:H,children:(0,s.jsx)(h.lL,{theme:H,defaultMode:"light",children:(0,s.jsx)($,{children:(0,s.jsx)("div",{className:"contents h-full",children:(0,s.jsx)(ee,{children:t})})})})})})})}},78915:function(e,t,i){"use strict";i.d(t,{Tk:function(){return d},Kw:function(){return h},PR:function(){return u},Ej:function(){return x}});var r=i(21628),n=i(24214),s=i(52040);let l=n.Z.create({baseURL:s.env.API_BASE_URL});l.defaults.timeout=1e4,l.interceptors.response.use(e=>e.data,e=>Promise.reject(e));var a=i(84835);let o={"content-type":"application/json"},c=e=>{if(!(0,a.isPlainObject)(e))return JSON.stringify(e);let t={...e};for(let e in t){let i=t[e];"string"==typeof i&&(t[e]=i.trim())}return JSON.stringify(t)},d=(e,t)=>{if(t){let i=Object.keys(t).filter(e=>void 0!==t[e]&&""!==t[e]).map(e=>"".concat(e,"=").concat(t[e])).join("&");i&&(e+="?".concat(i))}return l.get("/api"+e,{headers:o}).then(e=>e).catch(e=>{r.ZP.error(e),Promise.reject(e)})},h=(e,t)=>{let i=c(t);return l.post("/api"+e,{body:i,headers:o}).then(e=>e).catch(e=>{r.ZP.error(e),Promise.reject(e)})},u=(e,t)=>l.post(e,t,{headers:o}).then(e=>e).catch(e=>{r.ZP.error(e),Promise.reject(e)}),x=(e,t)=>l.post(e,t).then(e=>e).catch(e=>{r.ZP.error(e),Promise.reject(e)})},97402:function(){},23517:function(){}},function(e){e.O(0,[2180,780,272,8942,7518,5935,6316,8635,3191,2657,157,9253,5769,1744],function(){return e(e.s=91909)}),_N_E=e.O()}]);